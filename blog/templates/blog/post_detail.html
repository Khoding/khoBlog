{% extends 'blog/base_post.html' %}
{% load static comments comments_xtd markdown_extra post_cards %}

{% block additional_css %}
  <link rel="stylesheet" href="{% static 'khoBlog/css/highlight.css' %}" media="screen">
{% endblock additional_css %}

{% block page_top_end %}
  <nav class="btn-group float-end" role="group" aria-label="Previous / Next">
    <a class="btn btn-primary btn-sm" href="{{ prev_post.get_absolute_url }}">
      <i class="bi bi-chevron-left"></i>
    </a>

    <a class="btn btn-primary btn-sm" href="{{ next_post.get_absolute_url }}">
      <i class="bi bi-chevron-right"></i>
    </a>
  </nav>
{% endblock page_top_end %}

{% block page_top %}
  {{ block.super }}

  {% block page_top_hr %}{% endblock page_top_hr %}
{% endblock page_top %}

{% block content_main %}
  {% if not enable_tailwind_flag and not user.enable_tailwind %}
    {% render_cards post %}
  {% else %}
    <section class="text-gray-400 bg-gray-900 body-font">
      <article class="p-4 md:w-2/3 mx-auto">
        <nav class="flex justify-between" role="group" aria-label="Previous / Next">
          <a href="{{ prev_post.get_absolute_url }}">
            Previous
          </a>
          <a href="{{ next_post.get_absolute_url }}">
            Next
          </a>
        </nav>
        <div class="h-full border-2 border-gray-800 rounded-lg overflow-hidden">
          <section class="p-6">
            <h1 class="title-font text-5xl font-medium text-purple-200 mb-3 border-b-2 border-purple-200 ">{{ post.title }}</h1>
            <div class="prose lg:prose-lg xl:prose-xl prose-purple">
              {{ post.body|formatted_markdown|safe }}
            </div>
          </section>
        </div>
      </article>
    </section>
  {% endif %}

  <article class="card p-2 comments shadow mt-2">
    <h5 class="text-muted">Comments</h5>
    {% if post.enable_comments and not comments_disabled_globally_flag or user.is_superuser %}
      {% get_comment_count for post as comment_count %}

      {% render_comment_form for post %}
      <hr/>

      <p class="text-muted text-small">This post has
        {{ comment_count }}
        comment{{ comment_count|pluralize:'s' }}.</p>

      {% render_xtdcomment_tree for post allow_flagging allow_feedback show_feedback %}
    {% elif post.enable_comments and comments_disabled_globally_flag %}
      <p class="text-muted text-small">Comments were disabled globally.</p>
    {% else %}
      <p class="text-muted text-small">This post has comments disabled.</p>
    {% endif %}
  </article>
{% endblock content_main %}

{% block inside_aside %}
  {% include 'blog/includes/aside_nav_post_info.html' %}
{% endblock inside_aside %}

{% block inside_nav %}
  {% include 'blog/includes/aside_nav_post_info.html' %}
{% endblock inside_nav %}

{% block pagination %}{% endblock pagination %}
