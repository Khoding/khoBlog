{% extends 'pages/base_page.html' %}
{% load comments super_buttons %}

{% block page_head %}
    {% if page.page_head %}
        {% autoescape off %}
            {{ page.page_head }}
        {% endautoescape %}
    {% endif %}

    {{ block.super }}
{% endblock page_head %}

{% block main %}
    {% if not page.withdrawn or user.is_superuser %}
        <div class="card mb-2">
            {% if page.withdrawn %}
                <span class="position-absolute top-0 start-100 translate-middle badge border border-light rounded-circle bg-danger p-1" data-bs-toggle="tooltip" data-bs-placement="top" title="Withdrawn"><span class="visually-hidden">Withdrawn</span></span>
            {% endif %}

            <div class="card-header d-flex">
                <span class="col">
                    <h2>Page #{{ page.id }}</h2>
                </span>
                <span class="col-auto">
                    {% if user.is_superuser %}
                        {% sb page %}
                    {% endif %}
                </span>
            </div>

            <div class="card-body">
                {% autoescape off %}
                    <span class="card-text">{{ page.content }}</span>
                {% endautoescape %}
            </div>
        </div>

        {% if page.enable_comments %}
            {% get_comment_count for page as comment_count %}

            {% render_comment_form for page %}
            <hr />

            <p class="text-muted text-small">This page has {{ comment_count }} comment{{ comment_count|pluralize:'s' }}</p>

            {% render_comment_list for page %}
        {% else %}
            <p class="text-muted text-small">This page has comments disabled.</p>
        {% endif %}
    {% else %}
        <h1><a class="btn btn-danger" href="{% url 'pages:kheee' %}">{{ description }}</a></h1>
    {% endif %}
{% endblock main %}
